version: 2

models:
  - name: stg_video_info
    columns:
      - name: video_id
        tests:
          - not_null
          - relationships:
              to: ref('stg_comment_count')
              field: video_id
      - name: channel_id
        tests:
          - not_null  
      - name: File_Date
        tests:
          - relationships:
              field: File_Date
              to: ref('stg_comment_count')

  - name: stg_view_count
    columns:
      - name: video_id
        tests:
          - not_null
          - relationships:
              to: ref('stg_comment_count')
              field: video_id
      - name: File_Date
        tests:
          - relationships:
              field: File_Date
              to: ref('stg_comment_count')

  - name: stg_comment_count
    columns:
      - name: video_id
        tests:
          - not_null
          - relationships:
              to: ref('stg_video_info')
              field: video_id
          - relationships:
              to: ref('stg_view_count')
              field: video_id
      - name: File_Date
        tests:
          - relationships:
              field: File_Date
              to: ref('stg_video_info')
          - relationships:
              field: File_Date
              to: ref('stg_view_count')
    
